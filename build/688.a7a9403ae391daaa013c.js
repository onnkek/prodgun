"use strict";(self.webpackChunkprodgun=self.webpackChunkprodgun||[]).push([[688],{2688:(e,n,a)=>{a.r(n),a.d(n,{default:()=>J});var r,t=a(4848),o=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.validateErrors},l=a(5452);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(r||(r={}));var i=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.form},u=(0,l.zD)("profile/updateProfileData",(function(e,n){return a=void 0,t=void 0,l=function(){var e,a,t,o,l,u,c;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(s){switch(s.label){case 0:if(e=n.extra,a=n.rejectWithValue,t=n.getState,o=i(t()),(l=function(e){if(!e)return[r.NO_DATA];var n=[],a=e.first,t=e.lastname,o=e.age,l=e.country;return a&&t||n.push(r.INCORRECT_USER_DATA),o&&Number.isInteger(o)||n.push(r.INCORRECT_AGE),l||n.push(r.INCORRECT_COUNTRY),n}(o)).length)return[2,a(l)];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,e.api.put("/profile/".concat(null==o?void 0:o.id),o)];case 2:if(!(u=s.sent()).data)throw new Error;return[2,u.data];case 3:return c=s.sent(),console.log(c),[2,a([r.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function r(e){try{u(l.next(e))}catch(e){n(e)}}function i(e){try{u(l.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,i)}u((l=l.apply(a,t||[])).next())}));var a,t,o,l})),c=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.readonly},s=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.data},d=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.error},f=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.isLoading};const v={profileCard:"Rw9HqCl7",input:"zWwZFzfy",loading:"K82DAAF4",error:"lkCPH1O0",avatarWrapper:"sYkKlha_",editing:"uqwg92bZ"};var p,h=a(5435),y=a(2943),C=a(4940),g=a(7101),m=a(2214),R=a(5528),b=a(1090),x=a(5392);!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(p||(p={}));var E,N=a(6540),j=[{value:p.RUB,content:p.RUB},{value:p.EUR,content:p.EUR},{value:p.USD,content:p.USD}],O=(0,N.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,o=e.readonly,l=(0,h.B)().t,i=(0,N.useCallback)((function(e){null==r||r(e)}),[r]);return(0,t.jsx)(x.l,{className:n,label:l("Select currency"),options:j,value:a,onChange:i,readonly:o})}));!function(e){e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazakhstan",e.USA="USA",e.UK="UK"}(E||(E={}));var k=[{value:E.USA,content:E.USA},{value:E.UK,content:E.UK},{value:E.Russia,content:E.Russia},{value:E.Kazakhstan,content:E.Kazakhstan},{value:E.Belarus,content:E.Belarus},{value:E.Ukraine,content:E.Ukraine}],U=(0,N.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,o=e.readonly,l=(0,h.B)().t,i=(0,N.useCallback)((function(e){null==r||r(e)}),[r]);return(0,t.jsx)(x.l,{className:n,label:l("Select country"),options:k,value:a,onChange:i,readonly:o})})),w=function(e){var n,a,r=e.className,o=e.data,l=e.isLoading,i=e.error,u=e.onChangeFirstname,c=e.onChangeLastname,s=e.onChangeAge,d=e.onChangeCity,f=e.onChangeUsername,p=e.onChangeAvatar,x=e.onChangeCurrency,E=e.onChangeCountry,N=e.readonly,j=(0,h.B)("profile").t;if(l)return(0,t.jsx)("div",{className:(0,g.x)(v.profileCard,(n={},n[v.loading]=!0,n),[r]),children:(0,t.jsx)(m.a,{})});if(i)return(0,t.jsx)("div",{className:(0,g.x)(v.profileCard,{},[r,v.error]),children:(0,t.jsx)(y.E,{theme:R.$G.ERROR,align:R.nO.CENTER,title:j("Server error"),text:j("Try to reload page...")})});var k=((a={})[v.editing]=!N,a);return(0,t.jsx)("div",{className:(0,g.x)(v.profileCard,k,[r]),children:(0,t.jsxs)("div",{className:v.data,children:[(null==o?void 0:o.avatar)&&(0,t.jsx)("div",{className:v.avatarWrapper,children:(0,t.jsx)(b.e,{src:null==o?void 0:o.avatar,alt:j("Avatar")})}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.first,placeholder:j("Your first name"),onChange:u,readonly:N}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.lastname,placeholder:j("Your last name"),onChange:c,readonly:N}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.age,placeholder:j("Your age"),onChange:s,readonly:N}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.city,placeholder:j("Your city"),onChange:d,readonly:N}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.username,placeholder:j("Your username"),onChange:f,readonly:N}),(0,t.jsx)(C.p,{className:v.input,value:null==o?void 0:o.avatar,placeholder:j("Your avatar path"),onChange:p,readonly:N}),(0,t.jsx)(O,{className:v.input,value:null==o?void 0:o.currency,onChange:x,readonly:N}),(0,t.jsx)(U,{className:v.input,value:null==o?void 0:o.country,onChange:E,readonly:N})]})})},S=(0,l.zD)("profile/fetchProfileData",(function(e,n){return a=void 0,r=void 0,o=function(){var a,r,t,o;return function(e,n){var a,r,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(i){return function(u){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;o&&(o=0,i[0]&&(l=0)),l;)try{if(a=1,r&&(t=2&i[0]?r.return:i[0]?r.throw||((t=r.return)&&t.call(r),0):r.next)&&!(t=t.call(r,i[1])).done)return t;switch(r=0,t&&(i=[2&i[0],t.value]),i[0]){case 0:case 1:t=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!t||i[1]>t[0]&&i[1]<t[3])){l.label=i[1];break}if(6===i[0]&&l.label<t[1]){l.label=t[1],t=i;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(i);break}t[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],r=0}finally{a=t=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(l){switch(l.label){case 0:a=n.extra,r=n.rejectWithValue,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,a.api.get("/profile/".concat(e))];case 2:if(!(t=l.sent()).data)throw new Error;return[2,t.data];case 3:return o=l.sent(),console.log(o),[2,r("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function l(e){try{u(o.next(e))}catch(e){n(e)}}function i(e){try{u(o.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t((function(e){e(a)}))).then(l,i)}u((o=o.apply(a,r||[])).next())}));var a,r,t,o})),A=function(){return A=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},A.apply(this,arguments)},T=(0,l.Z0)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:function(e,n){e.form=A(A({},e.form),n.payload)}},extraReducers:function(e){e.addCase(S.pending,(function(e){e.error=void 0,e.isLoading=!0})).addCase(S.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(S.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(u.pending,(function(e){e.validateErrors=void 0,e.isLoading=!0})).addCase(u.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(u.rejected,(function(e,n){e.isLoading=!1,e.validateErrors=n.payload}))}}),_=T.actions,D=T.reducer,L=a(1468),P=a(3286),I=a(9630);const B="NUpgbVXJ";var Y=a(7948),K=a(1901),G=a(7850),z=function(e){var n=e.className,a=(0,h.B)().t,r=(0,L.d4)(c),o=(0,I.j)(),l=(0,L.d4)(G.ed),i=(0,L.d4)(s),d=(null==l?void 0:l.id)===(null==i?void 0:i.id),f=(0,N.useCallback)((function(){o(_.setReadonly(!1))}),[o]),v=(0,N.useCallback)((function(){o(_.cancelEdit())}),[o]),p=(0,N.useCallback)((function(){o(u())}),[o]);return(0,t.jsxs)("div",{className:(0,g.x)("pZAhUKL7",{},[n]),children:[(0,t.jsx)(y.E,{title:a("Profile")}),d&&(0,t.jsx)("div",{className:"tnnEhx4k",children:r?(0,t.jsx)(Y.$,{onClick:f,theme:K.Ox.OUTLINE,className:B,children:a("Edit")}):(0,t.jsxs)("div",{children:[(0,t.jsx)(Y.$,{onClick:p,theme:K.Ox.OUTLINE,className:B,children:a("Save")}),(0,t.jsx)(Y.$,{onClick:v,theme:K.Ox.OUTLINE_RED,className:B,children:a("Cancel")})]})})]})},V=a(9138),F=a(8106),M=a(8620),H={profile:D};const J=function(){var e,n=(0,h.B)().t,a=(0,I.j)(),l=(0,L.d4)(i),u=(0,L.d4)(f),s=(0,L.d4)(d),v=(0,L.d4)(c),p=(0,L.d4)(o),C=(0,F.g)().id,g=((e={})[r.SERVER_ERROR]=n("Server error while saving"),e[r.INCORRECT_COUNTRY]=n("Incorrect country"),e[r.NO_DATA]=n("The data is not specified"),e[r.INCORRECT_USER_DATA]=n("The first and last name cannot be empty"),e[r.INCORRECT_AGE]=n("Age should be a number"),e);(0,V.b)((function(){C&&a(S(C))}));var m=(0,N.useCallback)((function(e){a(_.updateProfile({first:e||""}))}),[a]),b=(0,N.useCallback)((function(e){a(_.updateProfile({lastname:e||""}))}),[a]),x=(0,N.useCallback)((function(e){a(_.updateProfile({age:Number(e||0)}))}),[a]),E=(0,N.useCallback)((function(e){a(_.updateProfile({city:e||""}))}),[a]),j=(0,N.useCallback)((function(e){a(_.updateProfile({username:e||""}))}),[a]),O=(0,N.useCallback)((function(e){a(_.updateProfile({avatar:e||""}))}),[a]),k=(0,N.useCallback)((function(e){a(_.updateProfile({currency:e}))}),[a]),U=(0,N.useCallback)((function(e){a(_.updateProfile({country:e}))}),[a]);return(0,t.jsx)(P.H,{reducers:H,removeAfterUnmount:!0,children:(0,t.jsxs)(M.Y,{children:[(0,t.jsx)(z,{}),(null==p?void 0:p.length)&&p.map((function(e){return(0,t.jsx)(y.E,{theme:R.$G.ERROR,text:g[e]},e)})),(0,t.jsx)(w,{data:l,isLoading:u,error:s,readonly:v,onChangeFirstname:m,onChangeLastname:b,onChangeAge:x,onChangeCity:E,onChangeUsername:j,onChangeAvatar:O,onChangeCurrency:k,onChangeCountry:U})]})})}},3286:(e,n,a)=>{a.d(n,{H:()=>i});var r=a(4848),t=a(6540),o=a(1468),l=a(9630),i=function(e){var n=e.children,a=e.reducers,i=e.removeAfterUnmount,u=void 0===i||i,c=(0,o.Pj)(),s=(0,l.j)();return(0,t.useEffect)((function(){var e=c.reducerManager.getMountedReducers();return Object.entries(a).forEach((function(n){var a=n[0],r=n[1];e[a]||(c.reducerManager.add(a,r),s({type:"@INIT ".concat(a," reducer")}))})),function(){u&&Object.entries(a).forEach((function(e){var n=e[0];e[1],c.reducerManager.remove(n),s({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,r.jsx)(r.Fragment,{children:n})}},1090:(e,n,a)=>{a.d(n,{e:()=>l});var r=a(4848),t=a(6540);var o=a(7101),l=function(e){var n=e.className,a=e.src,l=e.size,i=e.alt,u=(0,t.useMemo)((function(){return{width:l,height:l}}),[l]);return(0,r.jsx)("img",{src:a,alt:i,style:u,className:(0,o.x)("S0DAYK7a",{},[n])})}},4940:(e,n,a)=>{a.d(n,{p:()=>i});var r=a(4848),t=a(6540),o=a(7101);var l=function(){return l=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var t in n=arguments[a])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},l.apply(this,arguments)},i=(0,t.memo)((function(e){var n,a=e.className,i=e.value,u=e.onChange,c=e.type,s=void 0===c?"text":c,d=e.placeholder,f=e.autofocus,v=e.readonly,p=function(e,n){var a={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(a[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(r=Object.getOwnPropertySymbols(e);t<r.length;t++)n.indexOf(r[t])<0&&Object.prototype.propertyIsEnumerable.call(e,r[t])&&(a[r[t]]=e[r[t]])}return a}(e,["className","value","onChange","type","placeholder","autofocus","readonly"]),h=(0,t.useState)(!1),y=h[0],C=h[1],g=(0,t.useState)(0),m=g[0],R=g[1],b=(0,t.useRef)(null),x=y&&!v;(0,t.useEffect)((function(){var e;f&&(C(!0),null===(e=b.current)||void 0===e||e.focus())}),[f]);var E=((n={}).ihund40d=v,n);return(0,r.jsxs)("div",{className:(0,o.x)("QvC1RLL5",E,[a]),children:[d&&(0,r.jsx)("div",{className:"t7EElYL8",children:"".concat(d,">")}),(0,r.jsxs)("div",{className:"JSklTJgJ",children:[(0,r.jsx)("input",l({ref:b,className:"QVfsakBG",type:s,value:i,onChange:function(e){null==u||u(e.target.value),R(e.target.value.length)},onFocus:function(){C(!0)},onBlur:function(){C(!1)},onSelect:function(e){var n;R((null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.selectionStart)||0)},readOnly:v},p)),x&&(0,r.jsx)("span",{className:"DcRgthhE",style:{left:"".concat(8.8*m,"px")}})]})]})}))},5392:(e,n,a)=>{a.d(n,{l:()=>l});var r=a(4848),t=a(6540);var o=a(7101),l=function(e){var n,a=e.className,l=e.label,i=e.options,u=e.value,c=e.onChange,s=e.readonly,d=(0,t.useMemo)((function(){return null==i?void 0:i.map((function(e){return(0,r.jsx)("option",{className:"S4_E3XLZ",value:e.value,children:e.content},e.value)}))}),[i]),f=((n={}).HFpnlchv=s,n);return(0,r.jsxs)("div",{className:(0,o.x)("r8NM1yKV",f,[a]),children:[l&&(0,r.jsx)("span",{className:"GKq66g3L",children:"".concat(l,">")}),(0,r.jsx)("select",{className:"rXFnHJtE",value:u,onChange:function(e){null==c||c(e.target.value)},disabled:s,children:d})]})}}}]);